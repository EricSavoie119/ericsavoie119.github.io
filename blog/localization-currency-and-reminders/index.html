<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light">
    <meta name="supported-color-schemes" content="light">
    
    <!-- Meta tags will be dynamically updated by JavaScript -->
    <meta name="description" content="">
    <meta name="keywords" content="">
    
    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:image" content="">
    <meta property="og:url" content="">
    <meta property="article:published_time" content="">
    <meta property="article:author" content="Eric Savoie">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="">
    
    <title>Blog Post | Eric Savoie - iOS Developer</title>
    
    <!-- PWA Theme Colors -->
    <meta name="theme-color" content="#487eb0">
    <meta name="msapplication-TileColor" content="#431a00">
    
    <!-- Inline CSS for immediate rendering -->
    <link rel="stylesheet" href="/assets/css/pages/blog-post-inline.css?v=1">
    
    <!-- Main CSS -->
    <link rel="stylesheet" href="/assets/css/main.css?v=4">
    
    <!-- Markdown Parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
    
    <!-- Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>
    <script>
      // Immediate visibility enforcement
      document.documentElement.style.setProperty('background', '#273c75', 'important');
      document.documentElement.style.setProperty('background-color', '#273c75', 'important');
      document.documentElement.style.setProperty('color', '#ffffff', 'important');
      document.documentElement.style.setProperty('visibility', 'visible', 'important');
      document.documentElement.style.setProperty('color-scheme', 'light', 'important');
      
      if (document.body) {
        document.body.style.setProperty('background', '#273c75', 'important');
        document.body.style.setProperty('background-color', '#273c75', 'important');
        document.body.style.setProperty('color', '#ffffff', 'important');
        document.body.style.setProperty('visibility', 'visible', 'important');
        document.body.style.setProperty('opacity', '1', 'important');
        document.body.style.setProperty('color-scheme', 'light', 'important');
      }
    </script>

    <!-- Navigation -->
    <div id="site-navbar"></div>

    <script type="module">
      import { renderNavbar } from '/assets/js/components/navbar.js?v=1';
      renderNavbar('#site-navbar');
    </script>

    <!-- Blog Post Container -->
    <div class="blog-post-container">
        <div class="container">
            <div id="blog-post-content">
                <!-- Blog post content will be dynamically inserted here -->
                <div style="text-align: center; padding: 3rem;">
                    <p style="font-size: 1.2rem; color: #f5f6fa;">Loading post...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="site-footer"></div>

    <script type="module">
      import { renderFooter } from '/assets/js/components/footer.js?v=2';
      renderFooter('#site-footer');
    </script>

    <!-- Blog JavaScript -->
    <script type="module" src="/assets/js/utils/reading-time.js"></script>
    <script type="module" src="/assets/js/components/blog-manager.js"></script>
    
    <script type="module">
        // Initialize blog post rendering
        import { BlogManager } from '/assets/js/components/blog-manager.js';
        
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const querySlug = urlParams.get('slug');
            const normalizedPath = window.location.pathname.replace(/\/+$/, '');
            const pathParts = normalizedPath.split('/');
            const pathSlug = pathParts.length >= 3 && pathParts[1] === 'blog'
                ? decodeURIComponent(pathParts[2] || '')
                : null;

            // Legacy route support: /blog/post-template.html?slug=<slug> -> /blog/<slug>/
            if (normalizedPath === '/blog/post-template.html' && querySlug) {
                window.location.replace(`/blog/${encodeURIComponent(querySlug)}/`);
                return;
            }

            const slug = pathSlug && pathSlug !== 'post-template.html' ? pathSlug : querySlug;
            
            if (!slug) {
                document.getElementById('blog-post-content').innerHTML = `
                    <div class="blog-post-error" style="text-align: center; padding: 3rem;">
                        <h1 style="color: #f5f6fa; margin-bottom: 1rem;">Post Not Found</h1>
                        <p style="color: #f5f6fa; margin-bottom: 2rem;">No post slug provided in URL.</p>
                        <a href="/blog" class="btn btn--secondary">← Back to Blog</a>
                    </div>
                `;
                return;
            }
            
            // Initialize blog manager
            const blogManager = new BlogManager({
                postsDirectory: '/blog/posts/',
                manifestPath: '/blog/posts-manifest.json'
            });
            
            // Load posts and render the specific post
            try {
                await blogManager.loadPosts();
                await blogManager.renderPost(slug, document.getElementById('blog-post-content'));
            } catch (error) {
                console.error('Error loading blog post:', error);
                document.getElementById('blog-post-content').innerHTML = `
                    <div class="blog-post-error" style="text-align: center; padding: 3rem;">
                        <h1 style="color: #f5f6fa; margin-bottom: 1rem;">Error Loading Post</h1>
                        <p style="color: #f5f6fa; margin-bottom: 2rem;">There was an error loading this blog post. Please try again later.</p>
                        <a href="/blog" class="btn btn--secondary">← Back to Blog</a>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
